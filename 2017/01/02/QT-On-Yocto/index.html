<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <meta name="renderer" content="webkit">
  <meta http-equiv="X-UA-Compatible" content="IE=edge" >
  <link rel="dns-prefetch" href="http://muddog.github.io">
  <title>Enable QT developement for i.MX6UL | MudDog</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="Qt is a cross-platform application framework that is widely used for developing application software that can be run on various software and hardware platforms with little or no change in the underlyi">
<meta property="og:type" content="article">
<meta property="og:title" content="Enable QT developement for i.MX6UL">
<meta property="og:url" content="http://muddog.github.io/2017/01/02/QT-On-Yocto/index.html">
<meta property="og:site_name" content="MudDog">
<meta property="og:description" content="Qt is a cross-platform application framework that is widely used for developing application software that can be run on various software and hardware platforms with little or no change in the underlyi">
<meta property="og:image" content="http://ohx9w4r3g.bkt.clouddn.com/blog/qt/qtcreator-install.png">
<meta property="og:image" content="http://ohx9w4r3g.bkt.clouddn.com/blog/qt/qt_versions.png">
<meta property="og:image" content="http://ohx9w4r3g.bkt.clouddn.com/blog/qt/compilers.png">
<meta property="og:image" content="http://ohx9w4r3g.bkt.clouddn.com/blog/qt/debuggers.png">
<meta property="og:image" content="http://ohx9w4r3g.bkt.clouddn.com/blog/qt/kits.png">
<meta property="og:image" content="http://ohx9w4r3g.bkt.clouddn.com/blog/qt/devices.png">
<meta property="og:image" content="http://ohx9w4r3g.bkt.clouddn.com/blog/qt/build_settings.png">
<meta property="og:image" content="http://ohx9w4r3g.bkt.clouddn.com/blog/qt/run_settings.png">
<meta property="og:updated_time" content="2017-03-02T14:22:30.851Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Enable QT developement for i.MX6UL">
<meta name="twitter:description" content="Qt is a cross-platform application framework that is widely used for developing application software that can be run on various software and hardware platforms with little or no change in the underlyi">
<meta name="twitter:image" content="http://ohx9w4r3g.bkt.clouddn.com/blog/qt/qtcreator-install.png">
  
    <link rel="alternative" href="/atom.xml" title="MudDog" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.ico">
  
  <link rel="stylesheet" href="/main.css">
  

</head>

<body>
  <div id="container">
    <div class="left-col">
      <div class="overlay"></div>
<div class="intrude-less">
	<header id="header" class="inner">
		<a href="/" class="profilepic">
			
			<img src="/avatar.png" class="js-avatar">
			
		</a>

		<hgroup>
		  <h1 class="header-author"><a href="/">豆芽</a></h1>
		</hgroup>

		

		<nav class="header-menu">
			<ul>
			
				<li><a href="/">Home</a></li>
	        
				<li><a href="/tags/IoT">IoT</a></li>
	        
				<li><a href="/tags/embeded">Embeded</a></li>
	        
				<li><a href="/tags/photo">Photograph</a></li>
	        
			</ul>
		</nav>
		<nav class="header-smart-menu">
	        
    		
    			
    			<a class="js-smart-menu" data-idx="0" href="javascript:void(0)">所有文章</a>
    			
    			
            
    			
    			<a class="js-smart-menu" data-idx="1" href="javascript:void(0)">标签</a>
    			
    			
            
    			
    			<a class="js-smart-menu" data-idx="2" href="javascript:void(0)">关于我</a>
    			
    			
            
		</nav>
		<nav class="header-nav">
			<div class="social">
				
					<a class="github" target="_blank" href="https://github.com/muddog" title="github">github</a>
		        
					<a class="weibo" target="_blank" href="http://weibo.com/muddogxp/" title="weibo">weibo</a>
		        
					<a class="zhihu" target="_blank" href="https://www.zhihu.com/people/muddog" title="zhihu">zhihu</a>
		        
					<a class="linkedin" target="_blank" href="http://www.linkedin.com/in/xinyu-chen-eric" title="linkedin">linkedin</a>
		        
			</div>
		</nav>
	</header>		
</div>

    </div>
    <div class="mid-col">
      <nav id="mobile-nav">
  	<div class="overlay">
  		<div class="slider-trigger"><i class="icon-list"></i></div>
  		<h1 class="header-author js-mobile-header hide">豆芽</h1>
  	</div>
	<div class="intrude-less">
		<header id="header" class="inner">
			<div class="profilepic">
				
					<img src="/avatar.png" class="js-avatar">
				
			</div>
			<hgroup>
			  <h1 class="header-author">豆芽</h1>
			</hgroup>
			
			<nav class="header-menu">
				<ul>
				
					<li><a href="/">Home</a></li>
		        
					<li><a href="/tags/IoT">IoT</a></li>
		        
					<li><a href="/tags/embeded">Embeded</a></li>
		        
					<li><a href="/tags/photo">Photograph</a></li>
		        
				</ul>
			</nav>
			<nav class="header-nav">
				<div class="social">
					
						<a class="github" target="_blank" href="https://github.com/muddog" title="github">github</a>
			        
						<a class="weibo" target="_blank" href="http://weibo.com/muddogxp/" title="weibo">weibo</a>
			        
						<a class="zhihu" target="_blank" href="https://www.zhihu.com/people/muddog" title="zhihu">zhihu</a>
			        
						<a class="linkedin" target="_blank" href="http://www.linkedin.com/in/xinyu-chen-eric" title="linkedin">linkedin</a>
			        
				</div>
			</nav>
		</header>				
	</div>
</nav>

      <div class="body-wrap">
        <article id="post-QT-On-Yocto" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      Enable QT developement for i.MX6UL
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>Qt is a cross-platform application framework that is widely used for developing application software that can be run on various software and hardware platforms with little or no change in the underlying codebase, while still being a native application with native capabilities and speed. It is running in TV, Car, HMI, 3D Printer, almost covering all of the embedded areas. This document introduces how to setup the development environment to build Qt application, deploy to NXP’s i.MX6UL EVK board, and run application on the Linux BSP.</p>
<h2 id="Hardware-Requirement"><a href="#Hardware-Requirement" class="headerlink" title="Hardware Requirement"></a>Hardware Requirement</h2><ul>
<li>PC Host: x86_64 Ubuntu-16.10</li>
<li>Target: i.mx6ul 14x14 EVK with LCD pannel</li>
<li>Mico-SD card</li>
<li>Ethernet cable &amp; USB cable for console &amp; Power adapter</li>
</ul>
<h2 id="QT-SDK"><a href="#QT-SDK" class="headerlink" title="QT SDK"></a>QT SDK</h2><p>QT one ecosystem provide SDK to build powerful, connected and beautiful applications that run on any screen and across any platform. Here for embedded development, we need the following tools:</p>
<ol>
<li>Qt Creator IDE</li>
<li>Qt5.6 source code</li>
<li>HOST build toolchain</li>
<li>TARGET build toolchain<a id="more"></a>
Qt Creator is a cross-platform C++, JavaScript and QML integrated development environment which is part of the SDK for the Qt GUI Application development framework. It includes a visual debugger and an integrated GUI layout and forms designer. It can run on both Windows, MacOS and Linux, developer create a Qt application on PC HOST and debug the UI on HOST build with HOST toolchain firstly. When debug completed, developer could use TARGET toolchain to build the application, and deploy the binary to embedded system like i.MX6UL linux.</li>
</ol>
<p>The HOST toolchain would be downloaded with SDK, but the TARGET toolchain is downloaded by Yocto introduced below.</p>
<h3 id="Setup-Ubuntu"><a href="#Setup-Ubuntu" class="headerlink" title="Setup Ubuntu"></a>Setup Ubuntu</h3><p>The default GCC-6 on Ubuntu 16.10 has issue to build the lzop tools for Yocto, install the GCC-5 and create gcc/g++ link to GCC-5 under /usr/bin.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ sudo apt-get install gcc-5-base gcc-5-multilib</div></pre></td></tr></table></figure>
<p>Install required packages:<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">$ sudo apt-get install build-essential <span class="comment"># for g++</span></div><div class="line">$ sudo apt-get install libfontconfig1  <span class="comment"># for font config</span></div><div class="line">$ sudo apt-get install libglu1-mesa-dev <span class="comment"># for HOST OpenGL</span></div></pre></td></tr></table></figure></p>
<h3 id="Install-Qt-SDK"><a href="#Install-Qt-SDK" class="headerlink" title="Install Qt SDK"></a>Install Qt SDK</h3><p>Online or offline installer for Linux version can be found on:<br><a href="https://www.qt.io/download-open-source/#section-2" target="_blank" rel="external">https://www.qt.io/download-open-source/#section-2</a><br>For example, we download a online one here: <a href="http://download.qt.io/official_releases/online_installers/qt-unified-linux-x64-online.run" target="_blank" rel="external">http://download.qt.io/official_releases/online_installers/qt-unified-linux-x64-online.run</a></p>
<p>Grant the executable permission to this binary, and run it.<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">$ chmod +x qt-unified-linux-x64-2.0.4-online.run</div><div class="line">$ ./qt-unified-linux-x64-2.0.4-online.run</div></pre></td></tr></table></figure></p>
<p>If you do not have a QT account, just create one. Otherwise login with your account, then “Next”. When the installer asking you to chose the components, please chose the <strong>“Qt 5.6”</strong> which consistent with the Yocto i.MX target QT version with the <strong>“Toolchain”</strong> and <strong>“Source Components”</strong> selected. Also the <strong>“Qt Creator”</strong> is mandatory like below:<br><img src="http://ohx9w4r3g.bkt.clouddn.com/blog/qt/qtcreator-install.png" alt=""></p>
<p>The <strong>“Toolchain”</strong> is used for HOST build for applications, which you can debug your application on HOST before deploy to target. The <strong>“Source Components”</strong> contains the opensource code of QT and many examples.</p>
<p>After all the packages downloaded and installed, you can run the Qt Creator by:<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ &lt;Qt install dir&gt;/Tools/QtCreator/bin/qtcreator</div></pre></td></tr></table></figure></p>
<p>You would be able to open the examples in the Qt5.x source code and quickly use the HOST toolchain to build and run a example on PC.</p>
<h2 id="i-MX6UL-Yocto-BSP"><a href="#i-MX6UL-Yocto-BSP" class="headerlink" title="i.MX6UL Yocto BSP"></a>i.MX6UL Yocto BSP</h2><h3 id="Yocto-build"><a href="#Yocto-build" class="headerlink" title="Yocto build"></a>Yocto build</h3><p>Get the repo, this tool can be download from the following sites:</p>
<ul>
<li><a href="http://php.webtutor.pl/en/wp-content/uploads/2011/09/repo" target="_blank" rel="external">http://php.webtutor.pl/en/wp-content/uploads/2011/09/repo</a></li>
<li><a href="https://dl-ssl.google.com/dl/googlesource/git-repo/repo" target="_blank" rel="external">https://dl-ssl.google.com/dl/googlesource/git-repo/repo</a></li>
<li><a href="http://android.git.kernel.org/repo" target="_blank" rel="external">http://android.git.kernel.org/repo</a></li>
</ul>
<p>Please chose the workable one, for China user, the following is workable:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">$ curl http://php.webtutor.pl/en/wp-content/uploads/2011/09/repo &gt; ~/repo</div><div class="line">$ chmod a+x ~/repo</div><div class="line">$ <span class="built_in">export</span> PATH=<span class="variable">$PATH</span>:~/</div></pre></td></tr></table></figure>
<p><strong>Download FSL i.MX Yocto BSP</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">$ repo init -u git://git.freescale.com/imx/fsl-arm-yocto-bsp.git -b imx-4.1-krogo</div><div class="line">$ repo sync</div></pre></td></tr></table></figure>
<p><strong>Setup environment</strong></p>
<p>Be careful, that the ${DISTRO} should be set to “fsl-imx-xwayland”, not “fsl-imx-wayland”, otherwise you can not get the qtwayland plugin and other components installed. Definitely you can change the conf/local.conf to add the qt plugin to “fsl-imx-wayland” DISTRO.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ DISTRO=fsl-imx-xwayland MACHINE=imx6ulevk <span class="built_in">source</span> fsl-setup-release.sh -b build</div></pre></td></tr></table></figure>
<p><strong>Add SFTP support</strong></p>
<p>Qt Creator use the SFTP protocol to upload the target image file, so we have to install ssh-server-openssh package instead of dropbear by change the .bb file:</p>
<figure class="highlight diff"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div></pre></td><td class="code"><pre><div class="line">project sources/meta-fsl-bsp-release/</div><div class="line">diff --git a/imx/meta-sdk/recipes-fsl/images/fsl-image-validation-imx.bb b/imx/meta-sdk/recipes-fsl/images/fsl-image-validation-imx.bb</div><div class="line">index 8343223..9989f83 100644</div><div class="line"><span class="comment">--- a/imx/meta-sdk/recipes-fsl/images/fsl-image-validation-imx.bb</span></div><div class="line"><span class="comment">+++ b/imx/meta-sdk/recipes-fsl/images/fsl-image-validation-imx.bb</span></div><div class="line">@@ -20,7 +20,7 @@ IMAGE_FEATURES += " \</div><div class="line">     splash \</div><div class="line">     nfs-server \</div><div class="line">     tools-debug \</div><div class="line"><span class="deletion">-    ssh-server-dropbear \</span></div><div class="line"><span class="addition">+    ssh-server-openssh \</span></div><div class="line">     tools-testapps \</div><div class="line">     hwcodecs \</div><div class="line">     $&#123;@bb.utils.contains('DISTRO_FEATURES', 'wayland', '', \</div><div class="line">     </div><div class="line"></div><div class="line">project sources/meta-fsl-bsp-release/</div><div class="line">diff --git a/imx/meta-sdk/recipes-fsl/images/fsl-image-qt5-validation-imx.bb b/imx/meta-sdk/recipes-fsl/images/fsl-image-qt5-validation-imx.bb</div><div class="line">index 39c7841..2ab231d 100644</div><div class="line"><span class="comment">--- a/imx/meta-sdk/recipes-fsl/images/fsl-image-qt5-validation-imx.bb</span></div><div class="line"><span class="comment">+++ b/imx/meta-sdk/recipes-fsl/images/fsl-image-qt5-validation-imx.bb</span></div><div class="line">@@ -45,4 +45,7 @@ QT5_IMAGE_INSTALL_remove = " packagegroup-qt5-webengine"</div><div class="line"> </div><div class="line"> IMAGE_INSTALL += " \</div><div class="line"> $&#123;QT5_IMAGE_INSTALL&#125; \</div><div class="line"><span class="addition">+openssh \</span></div><div class="line"><span class="addition">+openssh-sftp \</span></div><div class="line"><span class="addition">+openssh-sftp-server \</span></div><div class="line"> "</div></pre></td></tr></table></figure>
<p><strong>Build rootfs</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ bitbake fsl-image-qt5</div></pre></td></tr></table></figure>
<p>Build the QT5 target toolchain, which would be used on the QTCreator to build and deploy the QT application:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ bitbake meta-toolchain-qt5</div></pre></td></tr></table></figure>
<h3 id="Deploy-SDcard-image"><a href="#Deploy-SDcard-image" class="headerlink" title="Deploy SDcard image"></a>Deploy SDcard image</h3><p>Deploy the rootfs, and install the cross compile toolchain, cross Qt5 library into HOST used by Qt Creator<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ sh tmp/deploy/sdk/fsl-imx-xwayland-glibc-x86_64-meta-toolchain-qt5-cortexa7hf-neon-toolchain-4.1.15-2.0.1.sh</div></pre></td></tr></table></figure></p>
<p>You will find the i.MX6UL uboot/zImage/rootfs(ext4)/sdcard image under: build/tmp/deploy/images/imx6ulevk/. Prepare your SD card, and use the following dd command to deploy whole images:<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ sudo dd <span class="keyword">if</span>=build/tmp/deploy/images/imx6ulevk/fsl-image-qt5-imx6ulevk.sdcard of=/dev/&lt;sdcard dev&gt;</div></pre></td></tr></table></figure></p>
<p>The Qt5 cross compile tools are installed under: /opt/fsl-imx-xwayland/4.1.15-2.0.1/sysroots/x86_64-pokysdk-linux/. The target configuration files, includes and libs are under opt/fsl-imx-xwayland/4.1.15-2.0.1/sysroots/cortexa7hf-neon-poky-linux-gnueabi/</p>
<h2 id="Qt-Creator-configure"><a href="#Qt-Creator-configure" class="headerlink" title="Qt Creator configure"></a>Qt Creator configure</h2><p>Launch Qt Creator, create one project or use the example project and open it.</p>
<h3 id="Configure-the-cross-toolchain"><a href="#Configure-the-cross-toolchain" class="headerlink" title="Configure the cross toolchain"></a>Configure the cross toolchain</h3><p>Open the “Build &amp; Run” settings from [Menu] -&gt; [Tools] -&gt; [Options…].</p>
<p>1) Add target Qt5 qmake (deploy before under /opt/fsl-imx-xwayland/4.1.15-2.0.1/sysroots/x86_64-pokysdk-linux/usr/bin/qt5) in the tab of “Qt versions”:</p>
<p><img src="http://ohx9w4r3g.bkt.clouddn.com/blog/qt/qt_versions.png" alt=""></p>
<p>2) Add cross compile g++/gcc toolchain:</p>
<ul>
<li>G++: /opt/fsl-imx-xwayland/4.1.15-2.0.1/sysroots/x86_64-pokysdk-linux/usr/bin/arm-poky-linux-gnueabi/arm-poky-linux-gnueabi-g++</li>
<li>GCC: /opt/fsl-imx-xwayland/4.1.15-2.0.1/sysroots/x86_64-pokysdk-linux/usr/bin/arm-poky-linux-gnueabi/arm-poky-linux-gnueabi-gcc</li>
</ul>
<p><img src="http://ohx9w4r3g.bkt.clouddn.com/blog/qt/compilers.png" alt=""></p>
<p>3) Add gdb host tool:</p>
<p>/opt/fsl-imx-xwayland/4.1.15-2.0.1/sysroots/x86_64-pokysdk-linux/usr/bin/arm-poky-linux-gnueabi/arm-poky-linux-gnueabi-gdb</p>
<p><img src="http://ohx9w4r3g.bkt.clouddn.com/blog/qt/debuggers.png" alt=""></p>
<p>4) Add Target Kits under the “Kits” Tab:</p>
<p>Select the correct Compiler/Debugger/Qt version created above. And make sure the “Qt mkspec” is set to <strong>linux-arm-gnueabi-g++</strong></p>
<p><img src="http://ohx9w4r3g.bkt.clouddn.com/blog/qt/kits.png" alt=""></p>
<h3 id="Qt-mkspec"><a href="#Qt-mkspec" class="headerlink" title="Qt mkspec"></a>Qt mkspec</h3><p>Update the mksepc file: <strong>/opt/fsl-imx-xwayland/4.1.15-2.0.1/sysroots/cortexa7hf-neon-poky-linux-gnueabi/usr/lib/qt5/mkspecs/linux-arm-gnueabi-g++/qmake.conf</strong> for the toolchain name (arm-poky-linux-gnueabi-), the –sysroot for linker, and the NEON VFP4 hardware float support (as the toolchain is built for hf). Without this update, the linked library can not be found and the link would failed due to different float-abi usage.</p>
<figure class="highlight diff"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div></pre></td><td class="code"><pre><div class="line"><span class="meta">@@ -1,5 +1,5 @@</span></div><div class="line"> #</div><div class="line"><span class="deletion">-# qmake configuration for building with arm-linux-gnueabi-g++</span></div><div class="line"><span class="addition">+# qmake configuration for building with arm-poky-linux-gnueabi-g++</span></div><div class="line"> #</div><div class="line"> </div><div class="line"> MAKEFILE_GENERATOR      = UNIX</div><div class="line"><span class="meta">@@ -11,14 +11,17 @@</span></div><div class="line"> include(../common/g++-unix.conf)</div><div class="line"> </div><div class="line"> # modifications to g++.conf</div><div class="line"><span class="deletion">-QMAKE_CC                = arm-linux-gnueabi-gcc</span></div><div class="line"><span class="deletion">-QMAKE_CXX               = arm-linux-gnueabi-g++</span></div><div class="line"><span class="deletion">-QMAKE_LINK              = arm-linux-gnueabi-g++</span></div><div class="line"><span class="deletion">-QMAKE_LINK_SHLIB        = arm-linux-gnueabi-g++</span></div><div class="line"><span class="addition">+QMAKE_CC                = arm-poky-linux-gnueabi-gcc</span></div><div class="line"><span class="addition">+QMAKE_CXX               = arm-poky-linux-gnueabi-g++</span></div><div class="line"><span class="addition">+QMAKE_LINK              = arm-poky-linux-gnueabi-g++</span></div><div class="line"><span class="addition">+QMAKE_LINK_SHLIB        = arm-poky-linux-gnueabi-g++</span></div><div class="line"><span class="addition">+</span></div><div class="line"><span class="addition">+QMAKE_LFLAGS += --sysroot=/opt/fsl-imx-xwayland/4.1.15-2.0.1/sysroots/cortexa7hf-neon-poky-linux-gnueabi -mfloat-abi=hard -mfpu=neon-vfpv4</span></div><div class="line"><span class="addition">+QMAKE_CXXFLAGS +=  -mfloat-abi=hard -mfpu=neon-vfpv4</span></div><div class="line"> </div><div class="line"> # modifications to linux.conf</div><div class="line"><span class="deletion">-QMAKE_AR                = arm-linux-gnueabi-ar cqs</span></div><div class="line"><span class="deletion">-QMAKE_OBJCOPY           = arm-linux-gnueabi-objcopy</span></div><div class="line"><span class="deletion">-QMAKE_NM                = arm-linux-gnueabi-nm -P</span></div><div class="line"><span class="deletion">-QMAKE_STRIP             = arm-linux-gnueabi-strip</span></div><div class="line"><span class="addition">+QMAKE_AR                = arm-poky-linux-gnueabi-ar cqs</span></div><div class="line"><span class="addition">+QMAKE_OBJCOPY           = arm-poky-linux-gnueabi-objcopy</span></div><div class="line"><span class="addition">+QMAKE_NM                = arm-poky-linux-gnueabi-nm -P</span></div><div class="line"><span class="addition">+QMAKE_STRIP             = arm-poky-linux-gnueabi-strip</span></div><div class="line"> load(qt_config)</div></pre></td></tr></table></figure>
<h3 id="Configure-the-remote-device"><a href="#Configure-the-remote-device" class="headerlink" title="Configure the remote device"></a>Configure the remote device</h3><p>Add one “Generic Linux” device for i.MX6UL EVK board. Input the correct IP address, SSH port and username. Click the “Test” button to test the connection between PC and EVK board.</p>
<p><img src="http://ohx9w4r3g.bkt.clouddn.com/blog/qt/devices.png" alt=""></p>
<h3 id="Configure-the-project"><a href="#Configure-the-project" class="headerlink" title="Configure the project"></a>Configure the project</h3><p><strong>Build &amp; Run</strong></p>
<p>After done above settings, the projects “Build &amp; Run” configurations would be automatically generated. You can see in the “Run” the default deploy way is using the SFTP to upload image files which mentioned above why we need openssh-sftp-server installed into rootfs. One thing to update is the “Arguments” in the “Run settings”, the “-platform wayland” should be added, as we use xwayland for Qt’s backend.</p>
<p>Build settings:<br><img src="http://ohx9w4r3g.bkt.clouddn.com/blog/qt/build_settings.png" alt=""></p>
<p>Run settings:<br><img src="http://ohx9w4r3g.bkt.clouddn.com/blog/qt/run_settings.png" alt=""></p>
<p><strong>.pro for build</strong></p>
<p>Modify the [project].pro file:</p>
<ul>
<li>Change the <strong>target.path</strong> to the target application location you want to download to the board.</li>
<li>Add three INCLUDEPATH env for target cross compile headers</li>
<li>Add macro defines for VFP and GL usage</li>
</ul>
<figure class="highlight makefile"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">...</div><div class="line">target.path = /home/root/audiodevices</div><div class="line">INSTALLS += target</div><div class="line">...</div><div class="line">INCLUDEPATH += /opt/fsl-imx-xwayland/4.1.15-2.0.1/sysroots/cortexa7hf-neon-poky-linux-gnueabi/usr/include/c++/5.3.0/</div><div class="line">INCLUDEPATH += /opt/fsl-imx-xwayland/4.1.15-2.0.1/sysroots/cortexa7hf-neon-poky-linux-gnueabi/usr/include/c++/5.3.0/arm-poky-linux-gnueabi/</div><div class="line">INCLUDEPATH += /opt/fsl-imx-xwayland/4.1.15-2.0.1/sysroots/cortexa7hf-neon-poky-linux-gnueabi/usr/include/</div><div class="line"></div><div class="line">DEFINES += __ARM_PCS_VFP QT_NO_OPENGL</div></pre></td></tr></table></figure>
<h2 id="FAQ"><a href="#FAQ" class="headerlink" title="FAQ"></a>FAQ</h2><h3 id="Why-touch-is-not-work-correctly"><a href="#Why-touch-is-not-work-correctly" class="headerlink" title="Why touch is not work correctly?"></a>Why touch is not work correctly?</h3><p>Please update the weston service init file to start touchscreen calibration process before first use:<br><figure class="highlight diff"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div></pre></td><td class="code"><pre><div class="line">index b4092bb..0942515 100644</div><div class="line"><span class="comment">--- a/imx/meta-bsp/recipes-graphics/wayland/weston-init/init</span></div><div class="line"><span class="comment">+++ b/imx/meta-bsp/recipes-graphics/wayland/weston-init/init</span></div><div class="line"><span class="meta">@@ -8,6 +8,8 @@</span></div><div class="line"> # Default-Stop:      0 1 6</div><div class="line"> ### END INIT INFO</div><div class="line"> </div><div class="line"><span class="addition">+WS_CALUDEV_FILE=/etc/udev/rules.d/20-touch.rules</span></div><div class="line"><span class="addition">+</span></div><div class="line"> if test -e /etc/default/weston ; then</div><div class="line">         . /etc/default/weston</div><div class="line"> fi</div><div class="line">@@ -30,6 +32,34 @@ done</div><div class="line"> case "$1" in</div><div class="line">   start)</div><div class="line">         weston-start -- $OPTARGS</div><div class="line"><span class="addition">+</span></div><div class="line"><span class="addition">+        # If there's no touchscreen device available, done</span></div><div class="line"><span class="addition">+        if [ ! -e /dev/input/touchscreen0 ] ; then</span></div><div class="line"><span class="addition">+            exit 0</span></div><div class="line"><span class="addition">+        fi</span></div><div class="line"><span class="addition">+</span></div><div class="line"><span class="addition">+        # If it was already calibrated, done</span></div><div class="line"><span class="addition">+        if [ -f "$WS_CALUDEV_FILE" ] ; then</span></div><div class="line"><span class="addition">+            exit 0</span></div><div class="line"><span class="addition">+        fi</span></div><div class="line"><span class="addition">+</span></div><div class="line"><span class="addition">+        # Run a calibration app and save output to udev rules</span></div><div class="line"><span class="addition">+        echo    "Calibrating touchscreen (first time only)"</span></div><div class="line"><span class="addition">+        echo</span></div><div class="line"><span class="addition">+        echo    "*** To continue, please complete the touchscreen calibration"</span></div><div class="line"><span class="addition">+        echo -n "*** by touching the crosshairs on the LCD screen"</span></div><div class="line"><span class="addition">+        sleep 1</span></div><div class="line"><span class="addition">+        CAL_VALUES=`weston-calibrator|cut -c21-`</span></div><div class="line"><span class="addition">+        echo 'SUBSYSTEM=="input", ENV&#123;WL_CALIBRATION&#125;="'$CAL_VALUES'"' &gt; $WS_CALUDEV_FILE</span></div><div class="line"><span class="addition">+        echo "."</span></div><div class="line"><span class="addition">+</span></div><div class="line"><span class="addition">+        # Reload and re-run udev rules and restart weston</span></div><div class="line"><span class="addition">+        udevadm control --reload</span></div><div class="line"><span class="addition">+        udevadm trigger</span></div><div class="line"><span class="addition">+        killproc weston</span></div><div class="line"><span class="addition">+        sleep 2</span></div><div class="line"><span class="addition">+</span></div><div class="line"><span class="addition">+        weston-start -- $OPTARGS</span></div><div class="line">   ;;</div><div class="line"> </div><div class="line">   stop)</div></pre></td></tr></table></figure></p>
<p>Everythings is done here, now you can build, run and debug your QT applications on the i.MX6UL EVK board.</p>

      
    </div>
    <div class="article-info article-info-index">
      
      <a href="/2017/01/02/QT-On-Yocto/" class="archive-article-date">
  	<time datetime="2017-01-02T05:18:44.405Z" itemprop="datePublished"><i class="icon-clock"></i>2017-01-02</time>
</a>
      
	<div class="article-tag tagcloud">
		<i class="icon-price-tags"></i>
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Linux/">Linux</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/QT/">QT</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Yocto/">Yocto</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/i-MX6/">i.MX6</a></li></ul>
	</div>

      

      <div class="clearfix"></div>
    </div>
  </div>
</article>

  
<nav id="article-nav">
  
    <a href="/2017/02/05/Krabi-Trip/" id="article-nav-newer" class="article-nav-link-wrap">
      <i class="icon-circle-left"></i>
      <div class="article-nav-title">
        
          在Krabi过春节
        
      </div>
    </a>
  
  
    <a href="/2016/12/24/Dog-Nanny/" id="article-nav-older" class="article-nav-link-wrap">
      <div class="article-nav-title">找回豆芽保姆</div>
      <i class="icon-circle-right"></i>
    </a>
  
</nav>




<div class="share_jia">
	<!-- JiaThis Button BEGIN -->
	<div class="jiathis_style">
		<span class="jiathis_txt">Share to: &nbsp; </span>
		<a class="jiathis_button_facebook"></a> 
	    <a class="jiathis_button_twitter"></a>
	    <a class="jiathis_button_plus"></a> 
	    <a class="jiathis_button_tsina"></a>
		<a class="jiathis_button_cqq"></a>
		<a class="jiathis_button_douban"></a>
		<a class="jiathis_button_weixin"></a>
		<a class="jiathis_button_tumblr"></a>
    <a href="http://www.jiathis.com/share" class="jiathis jiathis_txt jtico jtico_jiathis" target="_blank"></a>
	</div>
	<script type="text/javascript" src="//v3.jiathis.com/code/jia.js?uid=1405949716054953" charset="utf-8"></script>
	<!-- JiaThis Button END -->
</div>






<div class="duoshuo">
	<!-- 多说评论框 start -->
	<div class="ds-thread" data-thread-key="QT-On-Yocto" data-title="Enable QT developement for i.MX6UL" data-url="http://muddog.github.io/2017/01/02/QT-On-Yocto/"></div>
	<!-- 多说评论框 end -->
	<!-- 多说公共JS代码 start (一个网页只需插入一次) -->
	<script type="text/javascript">
	var duoshuoQuery = {short_name:"muddog"};
	(function() {
		var ds = document.createElement('script');
		ds.type = 'text/javascript';ds.async = true;
		ds.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') + '//static.duoshuo.com/embed.js';
		ds.charset = 'UTF-8';
		(document.getElementsByTagName('head')[0] 
		 || document.getElementsByTagName('body')[0]).appendChild(ds);
	})();
	</script>
	<!-- 多说公共JS代码 end -->
</div>





      </div>
      <footer id="footer">
  <div class="outer">
    <div id="footer-info">
    	<div class="footer-left">
    		&copy; 2017 豆芽
    	</div>
      	<div class="footer-right">
      		<a href="http://hexo.io/" target="_blank">Hexo</a>  Theme <a href="https://github.com/litten/hexo-theme-yilia" target="_blank">Yilia</a> by Litten
      	</div>
    </div>
  </div>
</footer>
    </div>
    <script>
	var yiliaConfig = {
		fancybox: true,
		mathjax: false,
		animate: true,
		isHome: false,
		isPost: true,
		isArchive: false,
		isTag: false,
		isCategory: false,
		open_in_new: false,
		root: "/",
		innerArchive: true
	}
</script>

<script src="/./main.js"></script>


    
<div class="tools-col">
  <ul class="btn-wrap">
    
      <li class="chose" data-hook="tools-section-all"><span class="text">全部</span><i class="icon-book"></i></li>
    
    
      <li data-hook="tools-section-tag"><span class="text">标签</span><i class="icon-price-tags"></i></li>
    
    
    
      <li data-hook="tools-section-me"><span class="text">我</span><i class="icon-smile"></i></li>
    
  </ul>
  <div class="tools-wrap">
    
    	<section class="tools-section tools-section-all chose">
    	</section>
    

    
    	<section class="tools-section tools-section-tag">
    			<div class="widget tagcloud" id="js-tagcloud">
    				<a href="/tags/Blocking/" style="font-size: 10px;">Blocking</a> <a href="/tags/Cache/" style="font-size: 10px;">Cache</a> <a href="/tags/Clocksource/" style="font-size: 10px;">Clocksource</a> <a href="/tags/DTLS/" style="font-size: 10px;">DTLS</a> <a href="/tags/Embeded/" style="font-size: 10px;">Embeded</a> <a href="/tags/FTP/" style="font-size: 10px;">FTP</a> <a href="/tags/Family/" style="font-size: 12.5px;">Family</a> <a href="/tags/Gstreamer/" style="font-size: 10px;">Gstreamer</a> <a href="/tags/HRTimer/" style="font-size: 10px;">HRTimer</a> <a href="/tags/Hangzhou/" style="font-size: 10px;">Hangzhou</a> <a href="/tags/IoT/" style="font-size: 15px;">IoT</a> <a href="/tags/Kernel/" style="font-size: 17.5px;">Kernel</a> <a href="/tags/Krabi/" style="font-size: 10px;">Krabi</a> <a href="/tags/Linux/" style="font-size: 20px;">Linux</a> <a href="/tags/Memory/" style="font-size: 10px;">Memory</a> <a href="/tags/Netfilter/" style="font-size: 12.5px;">Netfilter</a> <a href="/tags/Photography/" style="font-size: 12.5px;">Photography</a> <a href="/tags/Python/" style="font-size: 10px;">Python</a> <a href="/tags/QT/" style="font-size: 12.5px;">QT</a> <a href="/tags/RTOS/" style="font-size: 12.5px;">RTOS</a> <a href="/tags/TCP/" style="font-size: 10px;">TCP</a> <a href="/tags/Thread/" style="font-size: 12.5px;">Thread</a> <a href="/tags/Timekeeping/" style="font-size: 10px;">Timekeeping</a> <a href="/tags/Yocto/" style="font-size: 10px;">Yocto</a> <a href="/tags/buddy/" style="font-size: 10px;">buddy</a> <a href="/tags/handshake/" style="font-size: 10px;">handshake</a> <a href="/tags/i-MX6/" style="font-size: 10px;">i.MX6</a> <a href="/tags/mbed/" style="font-size: 10px;">mbed</a> <a href="/tags/mbedOS/" style="font-size: 10px;">mbedOS</a> <a href="/tags/mbedTLS/" style="font-size: 10px;">mbedTLS</a> <a href="/tags/豆芽保姆/" style="font-size: 10px;">豆芽保姆</a>
    			</div>
    	</section>
    

    

    
    	<section class="tools-section tools-section-me">
  	  	
  	  		<div class="aboutme-wrap" id="js-aboutme">土狗一只&lt;br&gt;&lt;br&gt;码农&lt;br&gt;嵌入式</div>
  	  	
    	</section>
    
  </div>
  
</div>
    <!-- Root element of PhotoSwipe. Must have class pswp. -->
<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">

    <!-- Background of PhotoSwipe. 
         It's a separate element as animating opacity is faster than rgba(). -->
    <div class="pswp__bg"></div>

    <!-- Slides wrapper with overflow:hidden. -->
    <div class="pswp__scroll-wrap">

        <!-- Container that holds slides. 
            PhotoSwipe keeps only 3 of them in the DOM to save memory.
            Don't modify these 3 pswp__item elements, data is added later on. -->
        <div class="pswp__container">
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
        </div>

        <!-- Default (PhotoSwipeUI_Default) interface on top of sliding area. Can be changed. -->
        <div class="pswp__ui pswp__ui--hidden">

            <div class="pswp__top-bar">

                <!--  Controls are self-explanatory. Order can be changed. -->

                <div class="pswp__counter"></div>

                <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>

                <button class="pswp__button pswp__button--share" style="display:none" title="Share"></button>

                <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>

                <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>

                <!-- Preloader demo http://codepen.io/dimsemenov/pen/yyBWoR -->
                <!-- element will get class pswp__preloader--active when preloader is running -->
                <div class="pswp__preloader">
                    <div class="pswp__preloader__icn">
                      <div class="pswp__preloader__cut">
                        <div class="pswp__preloader__donut"></div>
                      </div>
                    </div>
                </div>
            </div>

            <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
                <div class="pswp__share-tooltip"></div> 
            </div>

            <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
            </button>

            <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
            </button>

            <div class="pswp__caption">
                <div class="pswp__caption__center"></div>
            </div>

        </div>

    </div>

</div>
  </div>
</body>
</html>